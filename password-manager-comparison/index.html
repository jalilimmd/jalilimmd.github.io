<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Self-Hosted Password Manager Comparison</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }
        .tab-active {
            border-bottom: 2px solid #10b981; /* emerald-500 */
            color: #059669; /* emerald-600 */
        }
        .tab-inactive {
            border-bottom: 2px solid transparent;
            color: #6b7280; /* gray-500 */
        }
        .tab-inactive:hover {
            color: #374151; /* gray-700 */
        }
        
        /* Custom scrollbar for tables */
        .custom-scrollbar::-webkit-scrollbar {
            height: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-800">

    <!-- Header -->
    <header class="bg-slate-900 text-white py-8 px-4 shadow-lg">
        <div class="max-w-7xl mx-auto">
            <h1 class="text-3xl md:text-4xl font-bold flex items-center gap-3">
                <i data-lucide="lock" class="w-10 h-10 text-emerald-400"></i>
                Self-Hosted Manager Analysis
            </h1>
            <p class="mt-2 text-slate-400 text-lg">
                Technical comparison of Bitwarden, Vaultwarden, and Passbolt infrastructures.
            </p>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white shadow sticky top-0 z-20">
        <div class="max-w-7xl mx-auto px-4 overflow-x-auto">
            <div class="flex space-x-8" id="nav-container">
                <button onclick="switchTab('overview')" id="nav-overview" class="tab-active py-4 px-2 font-medium capitalize transition-colors whitespace-nowrap">Overview</button>
                <button onclick="switchTab('deep-dive')" id="nav-deep-dive" class="tab-inactive py-4 px-2 font-medium capitalize transition-colors whitespace-nowrap">Deep Dive</button>
                <button onclick="switchTab('resources')" id="nav-resources" class="tab-inactive py-4 px-2 font-medium capitalize transition-colors whitespace-nowrap">Resources</button>
                <button onclick="switchTab('decision-engine')" id="nav-decision-engine" class="tab-inactive py-4 px-2 font-medium capitalize transition-colors whitespace-nowrap">Decision Engine</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-8" id="main-content">
        <!-- Content injected via JS -->
    </main>

    <!-- JavaScript Application Logic -->
    <script>
        // --- Data ---
        const managers = {
            bitwarden: {
                id: 'bitwarden',
                name: 'Bitwarden (Official)',
                color: 'bg-blue-600',
                lightColor: 'bg-blue-50',
                textColor: 'text-blue-600',
                icon: 'shield',
                tagline: 'The Industry Standard',
                description: 'The official, audited, enterprise-grade solution using C# and .NET. Best for compliance-heavy environments.',
                specs: {
                    language: 'C# (.NET Core)',
                    ram: '2GB - 4GB+',
                    arch: 'Microservices (10+ containers)',
                    security: 'Zero-Knowledge (AES-256)',
                    trust: 'Full 3rd-Party Audits'
                }
            },
            vaultwarden: {
                id: 'vaultwarden',
                name: 'Vaultwarden',
                color: 'bg-indigo-600',
                lightColor: 'bg-indigo-50',
                textColor: 'text-indigo-600',
                icon: 'database',
                tagline: 'High Efficiency',
                description: 'Unofficial Rust implementation. Unlocks enterprise features for free and runs on minimal hardware (Raspberry Pi compatible).',
                specs: {
                    language: 'Rust',
                    ram: '~10MB - 128MB',
                    arch: 'Monolithic (1 container)',
                    security: 'Zero-Knowledge (AES-256)',
                    trust: 'Community Audit Only'
                }
            },
            passbolt: {
                id: 'passbolt',
                name: 'Passbolt',
                color: 'bg-rose-600',
                lightColor: 'bg-rose-50',
                textColor: 'text-rose-600',
                icon: 'users',
                tagline: 'Team Collaboration',
                description: 'Web-native, OpenPGP-based manager designed for DevOps teams and granular sharing permissions.',
                specs: {
                    language: 'PHP (CakePHP)',
                    ram: '1GB - 2GB',
                    arch: 'MVC Web App',
                    security: 'OpenPGP (Web of Trust)',
                    trust: 'Full 3rd-Party Audits'
                }
            }
        };

        const decisionQuestions = [
            {
                id: 'hardware',
                text: "What hardware will you run this on?",
                options: [
                    { id: 'low', text: "Low Power (Raspberry Pi, Small VPS, NAS)", favor: 'vaultwarden' },
                    { id: 'med', text: "Standard Server (2GB+ RAM)", favor: 'any' },
                    { id: 'legacy', text: "Existing LAMP/LEMP Stack", favor: 'passbolt' }
                ]
            },
            {
                id: 'compliance',
                text: "What are your compliance requirements?",
                options: [
                    { id: 'strict', text: "Strict: Must be fully audited & Official Support", favor: 'bitwarden' },
                    { id: 'opensource', text: "Open Source: Code transparency is enough", favor: 'any' },
                    { id: 'gpg', text: "Crypto: Must use GPG/OpenPGP standards", favor: 'passbolt' }
                ]
            },
            {
                id: 'features',
                text: "Which features are critical for you?",
                options: [
                    { id: 'sso_fido', text: "SSO & YubiKey (FIDO2) for Free", favor: 'vaultwarden' },
                    { id: 'sharing', text: "Complex granular sharing & Web of Trust", favor: 'passbolt' },
                    { id: 'standard', text: "Standard password management", favor: 'bitwarden' }
                ]
            }
        ];

        let currentTab = 'overview';
        let userAnswers = {};

        // --- Helper Components (Functions returning HTML strings) ---

        function FeatureCheck(value, label) {
            const icon = value 
                ? `<i data-lucide="check-circle" class="w-4 h-4 text-green-500 mr-2"></i>` 
                : `<i data-lucide="x-circle" class="w-4 h-4 text-red-500 mr-2"></i>`;
            return `<div class="flex items-center mb-1">${icon}<span class="text-sm text-gray-700">${label}</span></div>`;
        }

        function ResourceBar(label, value, width, color) {
            return `
                <div class="mb-4">
                    <div class="flex justify-between text-sm mb-1">
                        <span class="font-medium text-gray-700">${label}</span>
                        <span class="text-gray-500">${value}</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div class="h-2.5 rounded-full ${color}" style="width: ${width}"></div>
                    </div>
                </div>
            `;
        }

        // --- View Renderers ---

        function renderOverview() {
            const cards = Object.values(managers).map(m => `
                <div class="bg-white rounded-xl shadow-md hover:shadow-xl transition-shadow border border-gray-100 overflow-hidden flex flex-col animate-fade-in">
                    <div class="h-2 ${m.color}"></div>
                    <div class="p-6 flex-1">
                        <div class="flex items-center justify-between mb-4">
                            <div class="p-3 rounded-full bg-opacity-10 ${m.lightColor}">
                                <i data-lucide="${m.icon}" class="${m.textColor} w-6 h-6"></i>
                            </div>
                            <span class="px-3 py-1 bg-gray-100 text-xs font-bold uppercase text-gray-500 rounded-full tracking-wider">
                                ${m.specs.language}
                            </span>
                        </div>
                        <h2 class="text-2xl font-bold mb-1 text-gray-800">${m.name}</h2>
                        <p class="text-sm font-semibold mb-4 uppercase tracking-wide ${m.textColor}">${m.tagline}</p>
                        <p class="text-gray-600 mb-6 leading-relaxed text-sm">
                            ${m.description}
                        </p>
                        
                        <div class="space-y-3 bg-gray-50 p-4 rounded-lg">
                            <div class="flex items-center text-sm">
                                <i data-lucide="cpu" class="w-4 h-4 mr-2 text-gray-400"></i>
                                <span class="font-medium mr-2">RAM:</span> ${m.specs.ram}
                            </div>
                            <div class="flex items-center text-sm">
                                <i data-lucide="server" class="w-4 h-4 mr-2 text-gray-400"></i>
                                <span class="font-medium mr-2">Arch:</span> ${m.specs.arch}
                            </div>
                            <div class="flex items-center text-sm">
                                <i data-lucide="shield" class="w-4 h-4 mr-2 text-gray-400"></i>
                                <span class="font-medium mr-2">Trust:</span> ${m.specs.trust}
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');

            return `<div class="grid grid-cols-1 md:grid-cols-3 gap-6">${cards}</div>`;
        }

        function renderDeepDive() {
            return `
            <div class="space-y-8 animate-fade-in">
                <!-- Architecture -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i data-lucide="server" class="w-5 h-5 mr-2 text-blue-500"></i>
                        Backend Architecture & Engineering
                    </h3>
                    <div class="overflow-x-auto custom-scrollbar">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Feature</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Bitwarden</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Vaultwarden</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Passbolt</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td class="px-6 py-4 text-sm font-medium text-gray-900">Tech Stack</td>
                                    <td class="px-6 py-4 text-sm text-gray-600">C# / .NET Core</td>
                                    <td class="px-6 py-4 text-sm text-gray-600">Rust (Clean-room)</td>
                                    <td class="px-6 py-4 text-sm text-gray-600">PHP (CakePHP)</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 text-sm font-medium text-gray-900">Databases</td>
                                    <td class="px-6 py-4 text-sm text-gray-600">MSSQL, Postgres (Lite)</td>
                                    <td class="px-6 py-4 text-sm text-gray-600">SQLite (Default), MySQL</td>
                                    <td class="px-6 py-4 text-sm text-gray-600">MariaDB / MySQL</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 text-sm font-medium text-gray-900">Containers</td>
                                    <td class="px-6 py-4 text-sm text-gray-600">10-12 (Microservices)</td>
                                    <td class="px-6 py-4 text-sm text-gray-600">1 (Monolithic Binary)</td>
                                    <td class="px-6 py-4 text-sm text-gray-600">Web Svr + DB</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Security -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i data-lucide="key" class="w-5 h-5 mr-2 text-rose-500"></i>
                        Cryptographic Models
                    </h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <h4 class="font-bold text-lg mb-2 text-gray-800">Bitwarden & Vaultwarden</h4>
                            <p class="text-sm font-semibold text-blue-600 mb-2">Symmetric Master Key Model</p>
                            <ul class="list-disc list-inside text-sm space-y-2 text-gray-600">
                                <li>Uses <strong>PBKDF2-SHA256</strong> or <strong>Argon2id</strong>.</li>
                                <li>Zero-Knowledge: Server sees only hashed blobs.</li>
                                <li>Decryption happens strictly client-side.</li>
                            </ul>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <h4 class="font-bold text-lg mb-2 text-gray-800">Passbolt</h4>
                            <p class="text-sm font-semibold text-rose-600 mb-2">OpenPGP Web of Trust</p>
                            <ul class="list-disc list-inside text-sm space-y-2 text-gray-600">
                                <li>Based on <strong>GnuPG (GPG)</strong> keys.</li>
                                <li>Challenge-response auth (no password hash sent).</li>
                                <li>Granular Sharing: Individual encryption per user key.</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- UX Comparison -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i data-lucide="smartphone" class="w-5 h-5 mr-2 text-indigo-500"></i>
                        Client Ecosystem & UX
                    </h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="border p-4 rounded">
                            <div class="font-bold mb-2">Bitwarden (Official)</div>
                            ${FeatureCheck(true, "Native Mobile Apps")}
                            ${FeatureCheck(true, "Native Desktop Apps")}
                            ${FeatureCheck(true, "Excellent OS Autofill")}
                        </div>
                        <div class="border p-4 rounded relative bg-indigo-50 border-indigo-200">
                             <div class="absolute -top-2 -right-2 bg-yellow-400 text-yellow-900 text-[10px] px-2 py-0.5 rounded-full font-bold uppercase">Best Value</div>
                            <div class="font-bold mb-2 text-indigo-900">Vaultwarden</div>
                            ${FeatureCheck(true, "Uses Official BW Apps")}
                            ${FeatureCheck(true, "All BW Extensions")}
                            ${FeatureCheck(true, "Same UX as Official")}
                            <div class="flex items-start mt-2">
                                <i data-lucide="alert-triangle" class="w-3 h-3 flex-shrink-0 mt-1 mr-1 text-amber-500"></i>
                                <span class="text-xs text-gray-500 italic">Push notifications require relay server setup.</span>
                            </div>
                        </div>
                        <div class="border p-4 rounded">
                            <div class="font-bold mb-2">Passbolt</div>
                            ${FeatureCheck(true, "Robust Browser Ext")}
                            ${FeatureCheck(true, "Desktop App (Windows)")}
                            ${FeatureCheck(false, "Native Mobile Autofill")}
                            <div class="text-xs text-gray-500 italic mt-2">
                                UI optimized specifically for team folder sharing.
                            </div>
                        </div>
                    </div>
                </div>
            </div>`;
        }

        function renderResources() {
            return `
            <div class="bg-white rounded-lg shadow-lg p-8 animate-fade-in">
                <h2 class="text-2xl font-bold mb-6">Resource Utilization Simulator</h2>
                <p class="text-gray-600 mb-8">
                    Visual comparison of system requirements for a typical deployment. Note how architecture choice impacts hardware needs.
                </p>

                <div class="grid lg:grid-cols-2 gap-12">
                    <div>
                        <h3 class="font-bold text-lg mb-4 text-gray-700">RAM Consumption (Minimum)</h3>
                        ${ResourceBar("Bitwarden (Standard MSSQL)", "~2GB - 4GB", "100%", "bg-blue-600")}
                        ${ResourceBar("Passbolt (MariaDB)", "~1GB", "30%", "bg-rose-500")}
                        ${ResourceBar("Bitwarden (Lite/Unified)", "~1GB", "30%", "bg-blue-400")}
                        ${ResourceBar("Vaultwarden (Rust)", "~100MB", "5%", "bg-indigo-600")}
                        
                        <div class="mt-8 p-4 bg-indigo-50 rounded-lg border border-indigo-100 flex items-start">
                            <i data-lucide="info" class="w-5 h-5 mr-3 text-indigo-600 flex-shrink-0 mt-0.5"></i>
                            <div>
                                <h4 class="font-bold text-indigo-900 mb-1">Why is Vaultwarden so light?</h4>
                                <p class="text-sm text-indigo-800">
                                    Vaultwarden is written in <strong>Rust</strong>, which has no garbage collector and manages memory manually. 
                                    Bitwarden uses <strong>.NET Core</strong>, adding GC overhead. 
                                    Passbolt uses <strong>PHP</strong>, requiring a full web stack.
                                </p>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h3 class="font-bold text-lg mb-4 text-gray-700">Deployment Complexity</h3>
                        <div class="space-y-6">
                            <div>
                                <div class="flex justify-between mb-1">
                                    <span class="font-medium">Bitwarden Standard</span>
                                    <span class="text-xs bg-red-100 text-red-800 px-2 py-0.5 rounded">Heavy</span>
                                </div>
                                <div class="flex flex-wrap gap-1">
                                    ${Array(10).fill(0).map(() => 
                                        `<div class="h-8 w-8 bg-blue-600 rounded text-xs flex items-center justify-center text-white" title="Service Container">C</div>`
                                    ).join('')}
                                    <div class="h-8 w-16 bg-gray-200 rounded text-xs flex items-center justify-center text-gray-500">...</div>
                                </div>
                                <p class="text-xs text-gray-500 mt-1">Orchestration of 10+ microservice containers.</p>
                            </div>

                            <div>
                                <div class="flex justify-between mb-1">
                                    <span class="font-medium">Vaultwarden</span>
                                    <span class="text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded">Simple</span>
                                </div>
                                <div class="h-8 w-8 bg-indigo-600 rounded text-xs flex items-center justify-center text-white" title="Single Binary">1</div>
                                <p class="text-xs text-gray-500 mt-1">Single Docker container containing API, Frontend, and DB logic.</p>
                            </div>

                            <div>
                                <div class="flex justify-between mb-1">
                                    <span class="font-medium">Passbolt</span>
                                    <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded">Standard</span>
                                </div>
                                <div class="flex space-x-1">
                                    <div class="h-8 w-8 bg-rose-500 rounded text-xs flex items-center justify-center text-white" title="App">App</div>
                                    <div class="h-8 w-8 bg-gray-400 rounded text-xs flex items-center justify-center text-white" title="DB">DB</div>
                                </div>
                                <p class="text-xs text-gray-500 mt-1">Typical Web App + Database structure.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>`;
        }

        function renderDecisionEngine() {
            let questionsHtml = decisionQuestions.map(q => `
                <div class="mb-8 animate-fade-in">
                    <h3 class="font-semibold text-gray-800 mb-3">${q.text}</h3>
                    <div class="space-y-2">
                        ${q.options.map(opt => {
                            const isSelected = userAnswers[q.id]?.id === opt.id;
                            const btnClass = isSelected
                                ? 'border-purple-500 bg-purple-50 text-purple-700 ring-1 ring-purple-500'
                                : 'border-gray-200 hover:border-purple-300 hover:bg-gray-50';
                            
                            return `<button
                                onclick="handleAnswer('${q.id}', '${opt.id}', '${opt.favor}')"
                                class="w-full text-left px-4 py-3 rounded border transition-all ${btnClass}"
                            >
                                ${opt.text}
                            </button>`
                        }).join('')}
                    </div>
                </div>
            `).join('');

            let resultHtml = `
                <div class="text-center text-gray-400 h-full flex flex-col items-center justify-center min-h-[300px]">
                    <div class="w-16 h-16 border-4 border-gray-200 border-t-purple-400 rounded-full animate-spin mx-auto mb-4" style="animation-duration: 3s"></div>
                    <p>Awaiting your inputs...</p>
                </div>
            `;

            // Check if all questions are answered
            if (Object.keys(userAnswers).length === decisionQuestions.length) {
                const result = calculateResult();
                resultHtml = `
                    <div class="text-center animate-fade-in w-full max-w-sm mx-auto pt-8">
                        <div class="mb-2 text-sm text-gray-500 uppercase tracking-widest font-bold">Recommended</div>
                        <div class="inline-block p-4 rounded-full ${result.color} text-white mb-4 shadow-lg">
                            <i data-lucide="${result.icon}" class="w-8 h-8"></i>
                        </div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2">${result.name}</h2>
                        <p class="text-xl text-purple-600 mb-6">${result.tagline}</p>
                        <p class="text-gray-600 mb-8 leading-relaxed text-sm">${result.description}</p>
                        
                        <div class="bg-white p-4 rounded shadow-sm text-left text-sm space-y-2 mb-8">
                            <div class="font-bold text-gray-700 border-b pb-2 mb-2">Key specs for you:</div>
                            <div class="flex justify-between">
                                <span>RAM:</span>
                                <span class="font-mono text-gray-600">${result.specs.ram}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Security:</span>
                                <span class="font-mono text-gray-600">${result.specs.security.split(' ')[0]}</span>
                            </div>
                        </div>

                        <button onclick="resetEngine()" class="text-gray-500 hover:text-gray-800 underline text-sm">
                            Start Over
                        </button>
                    </div>
                `;
            }

            return `
                <div class="bg-white rounded-lg shadow-lg overflow-hidden flex flex-col md:flex-row min-h-[600px] animate-fade-in">
                    <div class="p-8 md:w-1/2 border-r border-gray-100">
                        <h2 class="text-2xl font-bold mb-6 flex items-center">
                            <i data-lucide="layout" class="w-6 h-6 mr-2 text-purple-600"></i>
                            Selection Wizard
                        </h2>
                        <p class="text-gray-600 mb-8">Answer 3 questions to find your ideal self-hosted solution.</p>
                        ${questionsHtml}
                    </div>
                    <div class="md:w-1/2 bg-gray-50 p-8">
                        ${resultHtml}
                    </div>
                </div>
            `;
        }

        // --- Logic ---

        function handleAnswer(qId, optId, favor) {
            userAnswers[qId] = { id: optId, favor: favor };
            renderContent(); // Re-render to update classes and show result
        }

        function calculateResult() {
            // Logic priority based on markdown conclusion
            if (userAnswers.compliance.id === 'strict') return managers.bitwarden;
            if (userAnswers.hardware.id === 'low') return managers.vaultwarden;
            if (userAnswers.features.id === 'sso_fido') return managers.vaultwarden;
            if (userAnswers.features.id === 'sharing' || userAnswers.compliance.id === 'gpg') return managers.passbolt;
            if (userAnswers.hardware.id === 'legacy') return managers.passbolt;
            
            return managers.vaultwarden; // Default best value
        }

        function resetEngine() {
            userAnswers = {};
            renderContent();
        }

        function switchTab(tabName) {
            currentTab = tabName;
            
            // Update Nav Classes
            document.querySelectorAll('nav button').forEach(btn => {
                if (btn.id === `nav-${tabName}`) {
                    btn.classList.remove('tab-inactive');
                    btn.classList.add('tab-active');
                } else {
                    btn.classList.remove('tab-active');
                    btn.classList.add('tab-inactive');
                }
            });

            renderContent();
        }

        function renderContent() {
            const container = document.getElementById('main-content');
            
            if (currentTab === 'overview') {
                container.innerHTML = renderOverview();
            } else if (currentTab === 'deep-dive') {
                container.innerHTML = renderDeepDive();
            } else if (currentTab === 'resources') {
                container.innerHTML = renderResources();
            } else if (currentTab === 'decision-engine') {
                container.innerHTML = renderDecisionEngine();
            }

            // Re-initialize icons after DOM injection
            lucide.createIcons();
        }

        // --- Init ---
        document.addEventListener('DOMContentLoaded', () => {
            renderContent();
        });

    </script>
</body>
</html>
