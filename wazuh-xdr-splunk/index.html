<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wazuh XDR & Splunk Integration Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Tech Clarity -->
    <!-- Application Structure Plan: The application is designed as a single-page interactive guide with a fixed top navigation for easy access to different thematic sections. This structure was chosen over a linear document to allow the user, likely a busy IT professional, to quickly jump to the information most relevant to them. The flow is: 1) A 'Dashboard' to provide a direct answer to the main question and an overview. 2) An 'Introduction' to explain the 'what' and 'why' of Wazuh. 3) An 'Integration Strategy' section with a visual diagram for the 'how'. 4) An interactive 'Deployment Blueprints' section for environment-specific guidance. 5) A 'Synergy' section to explain the value-add of XDR over simple logging. 6) A final 'Best Practices' checklist for actionable takeaways. 7) An 'AI Generator' to provide a practical tool. This non-linear, thematic structure makes complex information digestible and task-oriented. -->
    <!-- Visualization & Content Choices: 1) Main Question: "Can Wazuh just forward logs to Splunk?" -> Goal: Inform -> Method: Prominent text block and an HTML/CSS architectural diagram. -> Interaction: Hover effects on diagram components to explain their roles. -> Justification: Directly answers the user's core question and provides immediate architectural context. 2) Introduction -> Goal: Explain -> Method: Icon-based feature cards. -> Justification: Breaks down core XDR concepts into easily understandable benefits. 3) Environment-specific deployment -> Goal: Organize/Guide -> Method: Interactive tabs for different asset types (K8s, Linux, etc.). -> Interaction: Clicking a tab reveals tailored advice and code snippets. -> Justification: Breaks down a complex deployment matrix into a user-driven, easy-to-navigate interface. 4) Value of XDR vs. Logs -> Goal: Compare -> Method: Interactive cards for Wazuh features and a Chart.js bar chart comparing data richness. -> Interaction: Clicking cards reveals details; the chart provides a quick visual summary. -> Justification: Clearly articulates the benefits of the integrated solution beyond basic logging. 5) Best Practices -> Goal: Summarize -> Method: A two-column checklist. -> Interaction: Simple hover effects. -> Justification: Provides a scannable, actionable summary. 6) AI Rule Generation -> Goal: Utility -> Method: A form that calls the Gemini API. -> Interaction: User inputs a log, clicks a button, gets a result. -> Justification: Provides a valuable, time-saving tool directly within the guide. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
            color: #334155; /* slate-700 */
        }
        .nav-link {
            transition: color 0.3s, border-color 0.3s;
        }
        .nav-link.active {
            color: #4f46e5; /* indigo-600 */
            border-bottom-color: #4f46e5;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .blueprint-tab.active {
            background-color: #4f46e5; /* indigo-600 */
            color: white;
        }
        .synergy-card {
            border: 1px solid #e2e8f0; /* slate-200 */
            cursor: pointer;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 text-xl font-bold text-indigo-600">
                        Wazuh + Splunk
                    </div>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#dashboard" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:text-indigo-600 border-b-2 border-transparent">Dashboard</a>
                        <a href="#introduction" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:text-indigo-600 border-b-2 border-transparent">Introduction</a>
                        <a href="#integration" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:text-indigo-600 border-b-2 border-transparent">Integration</a>
                        <a href="#blueprints" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:text-indigo-600 border-b-2 border-transparent">Blueprints</a>
                        <a href="#synergy" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:text-indigo-600 border-b-2 border-transparent">Synergy</a>
                        <a href="#practices" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:text-indigo-600 border-b-2 border-transparent">Practices</a>
                        <a href="#ai-generator" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:text-indigo-600 border-b-2 border-transparent">AI Generator</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12">
        
        <section id="dashboard" class="scroll-mt-20">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900 text-center">Integrating Wazuh XDR with Splunk SIEM</h1>
            <p class="mt-4 max-w-3xl mx-auto text-center text-lg text-slate-600">A practical guide to enhancing your security posture by combining Wazuh's endpoint visibility with Splunk's powerful analytics.</p>
            
            <div class="mt-12 card p-6 md:p-8 max-w-4xl mx-auto">
                <h2 class="text-2xl font-semibold text-slate-800">Can Wazuh send logs to Splunk without being the SIEM?</h2>
                <p class="mt-4 text-slate-600">
                    <span class="font-bold text-indigo-600">Yes, absolutely.</span> This is a powerful and common architecture. You can leverage Wazuh as a comprehensive XDR agent for endpoint data collection, threat detection, and response, while forwarding all alerts and enriched event data to Splunk for centralized analysis, long-term storage, and correlation with other data sources.
                </p>
                <div class="mt-6 p-4 bg-indigo-50 border border-indigo-200 rounded-lg">
                    <p class="text-indigo-800"><span class="font-semibold">The Core Idea:</span> Use each platform for its primary strength. Wazuh excels at deep endpoint security monitoring (FIM, vulnerability scanning, etc.), and Splunk excels at large-scale data aggregation, search, and analytics. Together, they create a robust, multi-layered security solution.</p>
                </div>
            </div>
        </section>

        <section id="introduction" class="mt-20 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-900 text-center">What is Wazuh XDR & How Does It Improve Security?</h2>
            <p class="mt-4 max-w-3xl mx-auto text-center text-lg text-slate-600">Wazuh is a free and open-source security platform that unifies Extended Detection and Response (XDR) and Security Information and Event Management (SIEM) capabilities. It functions as a powerful security agent that provides deep visibility and protection across your entire infrastructure‚Äîfrom on-premise servers and corporate endpoints to cloud workloads and containers.</p>
            
            <div class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="card p-6">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 h-12 w-12 rounded-md bg-indigo-500 text-white flex items-center justify-center text-2xl">üëÅÔ∏è</div>
                        <h3 class="ml-4 text-xl font-bold text-slate-800">Unified Visibility</h3>
                    </div>
                    <p class="mt-4 text-slate-600">Wazuh collects, aggregates, indexes, and analyzes security data from across your organization. This gives you a centralized view of your security posture, making it easier to detect threats that move laterally across different systems.</p>
                </div>
                <div class="card p-6">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 h-12 w-12 rounded-md bg-indigo-500 text-white flex items-center justify-center text-2xl">üõ°Ô∏è</div>
                        <h3 class="ml-4 text-xl font-bold text-slate-800">Proactive Threat Detection</h3>
                    </div>
                    <p class="mt-4 text-slate-600">Instead of just reacting to logs, Wazuh actively hunts for threats. It uses File Integrity Monitoring (FIM) to detect unauthorized changes, scans for known vulnerabilities (CVEs), and assesses system configurations against security benchmarks (CIS) to find weaknesses before they are exploited.</p>
                </div>
                 <div class="card p-6">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 h-12 w-12 rounded-md bg-indigo-500 text-white flex items-center justify-center text-2xl">‚ö°</div>
                        <h3 class="ml-4 text-xl font-bold text-slate-800">Rapid Incident Response</h3>
                    </div>
                    <p class="mt-4 text-slate-600">When a threat is detected, Wazuh's active response capabilities can automatically execute countermeasures, such as blocking a malicious IP address, disabling a compromised user account, or quarantining an infected endpoint. This drastically reduces threat containment time.</p>
                </div>
                <div class="card p-6">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 h-12 w-12 rounded-md bg-indigo-500 text-white flex items-center justify-center text-2xl">üìú</div>
                        <h3 class="ml-4 text-xl font-bold text-slate-800">Compliance & Auditing</h3>
                    </div>
                    <p class="mt-4 text-slate-600">Wazuh helps organizations meet regulatory requirements like PCI DSS, GDPR, and HIPAA. It provides out-of-the-box rules and reports mapped to these standards, simplifying the process of generating audit evidence and proving compliance.</p>
                </div>
            </div>
        </section>

        <section id="integration" class="mt-20 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-900 text-center">High-Level Integration Strategy</h2>
            <p class="mt-4 max-w-3xl mx-auto text-center text-lg text-slate-600">Visualize the flow of security data from your diverse assets into Splunk, enriched by Wazuh's XDR capabilities.</p>
            
            <div class="mt-12 card p-6 md:p-8">
                <div class="flex flex-col md:flex-row items-center justify-around gap-8 text-center">
                    <div class="w-full md:w-1/4">
                        <div class="p-4 bg-slate-100 rounded-lg">
                            <h3 class="font-bold text-slate-800">1. Assets</h3>
                            <p class="text-sm text-slate-600 mt-1">K8s Clusters, Servers, VPS, Workstations</p>
                            <div class="mt-3 text-2xl">üñ•Ô∏è</div>
                        </div>
                        <p class="mt-2 text-xs text-slate-500">Wazuh Agent installed</p>
                    </div>

                    <div class="text-4xl text-slate-400 font-thin self-center transform rotate-90 md:rotate-0">‚Üí</div>
                    
                    <div class="w-full md:w-1/4">
                        <div class="p-4 bg-slate-100 rounded-lg">
                            <h3 class="font-bold text-slate-800">2. Wazuh Manager</h3>
                            <p class="text-sm text-slate-600 mt-1">Analyzes Agent Data, Generates Alerts</p>
                             <div class="mt-3 text-2xl">üõ°Ô∏è</div>
                        </div>
                        <p class="mt-2 text-xs text-slate-500">Filters & enriches events</p>
                    </div>

                    <div class="text-4xl text-slate-400 font-thin self-center transform rotate-90 md:rotate-0">‚Üí</div>

                    <div class="w-full md:w-1/4">
                        <div class="p-4 bg-slate-100 rounded-lg">
                           <h3 class="font-bold text-slate-800">3. Logstash / Forwarder</h3>
                            <p class="text-sm text-slate-600 mt-1">(Optional) For Buffering & Routing</p>
                             <div class="mt-3 text-2xl">üîÑ</div>
                        </div>
                        <p class="mt-2 text-xs text-slate-500">Routes alerts.json</p>
                    </div>
                    
                    <div class="text-4xl text-slate-400 font-thin self-center transform rotate-90 md:rotate-0">‚Üí</div>

                    <div class="w-full md:w-1/4">
                        <div class="p-4 bg-indigo-100 rounded-lg border border-indigo-300">
                           <h3 class="font-bold text-indigo-800">4. Splunk</h3>
                           <p class="text-sm text-indigo-700 mt-1">SIEM for Correlation & Analysis</p>
                           <div class="mt-3 text-2xl">üìä</div>
                        </div>
                         <p class="mt-2 text-xs text-slate-500">Centralized visibility</p>
                    </div>
                </div>

                <div class="mt-8 pt-6 border-t border-slate-200">
                    <h3 class="text-xl font-semibold text-slate-800">Key Steps:</h3>
                    <ol class="list-decimal list-inside mt-4 space-y-2 text-slate-600">
                        <li><strong>Deploy Wazuh Agents:</strong> Install agents on all target assets (servers, endpoints, cluster nodes).</li>
                        <li><strong>Configure the Wazuh Manager:</strong> Set up the manager to receive data from agents.</li>
                        <li><strong>Enable Log Forwarding:</strong> Configure the Wazuh Manager (`ossec.conf`) to output alerts in JSON format (`<log_format>json</log_format>`).</li>
                        <li><strong>Set up a Forwarder:</strong> Use Logstash, Splunk Universal Forwarder, or a simple script to read the `alerts.json` file from the Wazuh Manager.</li>
                        <li><strong>Ingest into Splunk:</strong> Configure a Splunk data input (e.g., HTTP Event Collector or TCP/UDP) to receive the JSON data from your forwarder. The Wazuh App for Splunk is highly recommended for pre-built dashboards and parsing.</li>
                    </ol>
                </div>
            </div>
        </section>

        <section id="blueprints" class="mt-20 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-900 text-center">Interactive Deployment Blueprints</h2>
            <p class="mt-4 max-w-3xl mx-auto text-center text-lg text-slate-600">Select an environment to see tailored agent deployment advice and best practices.</p>

            <div class="mt-12 flex flex-wrap justify-center gap-2 md:gap-4" id="blueprint-tabs">
                <button data-target="k8s" class="blueprint-tab active px-4 py-2 rounded-full text-sm font-semibold border border-slate-300 transition">Kubernetes Clusters</button>
                <button data-target="linux" class="blueprint-tab px-4 py-2 rounded-full text-sm font-semibold border border-slate-300 transition">Linux Servers / VPS</button>
                <button data-target="windows" class="blueprint-tab px-4 py-2 rounded-full text-sm font-semibold border border-slate-300 transition">Corporate Workstations</button>
                <button data-target="network" class="blueprint-tab px-4 py-2 rounded-full text-sm font-semibold border border-slate-300 transition">Network Devices</button>
            </div>

            <div id="blueprint-content" class="mt-8">
                <div id="k8s" class="blueprint-pane">
                    <div class="card p-6 md:p-8">
                        <h3 class="text-xl font-bold text-slate-800">Kubernetes Clusters (Dev, Prod, Stage)</h3>
                        <p class="mt-2 text-slate-600">Deploy Wazuh agents as a DaemonSet to ensure all current and future nodes in your cluster are monitored.</p>
                        <ul class="list-disc list-inside mt-4 space-y-2 text-slate-600">
                            <li><strong>Method:</strong> Use the official Wazuh Helm chart or manifest files to deploy the agent DaemonSet.</li>
                            <li><strong>Configuration:</strong> Pass the `WAZUH_MANAGER` address as an environment variable to the agent pods.</li>
                            <li><strong>Key Focus:</strong> Monitor container runtime activity, Kubernetes API audit logs, and node-level security (CIS benchmarks). Integrate with tools like Falco for deeper container threat detection.</li>
                            <li><strong>Best Practice:</strong> Use separate agent groups for your dev, stage, and prod clusters to apply different security policies and rule levels.</li>
                        </ul>
                    </div>
                </div>
                <div id="linux" class="blueprint-pane hidden">
                    <div class="card p-6 md:p-8">
                        <h3 class="text-xl font-bold text-slate-800">Linux Servers & VPS</h3>
                        <p class="mt-2 text-slate-600">A standard agent installation provides deep visibility into your Linux hosts.</p>
                         <ul class="list-disc list-inside mt-4 space-y-2 text-slate-600">
                            <li><strong>Method:</strong> Use the system's package manager (apt, yum) with the Wazuh repository for easy installation and updates.</li>
                            <li><strong>Command Example:</strong> <code class="text-sm bg-slate-100 p-1 rounded">WAZUH_MANAGER="your.manager.ip" apt-get install wazuh-agent</code></li>
                            <li><strong>Key Focus:</strong> File Integrity Monitoring (FIM) on critical directories (`/etc`, `/bin`), log analysis for SSH access and application logs, rootkit detection, and vulnerability scanning.</li>
                            <li><strong>Best Practice:</strong> Create a baseline FIM snapshot after initial server hardening. This reduces noise from legitimate changes during setup.</li>
                        </ul>
                    </div>
                </div>
                <div id="windows" class="blueprint-pane hidden">
                    <div class="card p-6 md:p-8">
                        <h3 class="text-xl font-bold text-slate-800">Corporate Workstations (Windows/macOS)</h3>
                        <p class="mt-2 text-slate-600">Monitor endpoints for signs of malware, policy violations, and unauthorized software.</p>
                        <ul class="list-disc list-inside mt-4 space-y-2 text-slate-600">
                            <li><strong>Method:</strong> Deploy the agent using management tools like SCCM, Intune, or Jamf. The MSI installer for Windows supports command-line parameters for silent, pre-configured installation.</li>
                            <li><strong>Key Focus:</strong> Monitor Windows Event Logs (especially for logon failures, process creation), check for known malware signatures, enforce USB device policies, and assess security configurations (SCA).</li>
                            <li><strong>Best Practice:</strong> Enable active response features cautiously. Start by blocking malicious IPs known from threat intelligence feeds, but avoid aggressive actions like process termination until policies are well-tuned to prevent disruption.</li>
                        </ul>
                    </div>
                </div>
                <div id="network" class="blueprint-pane hidden">
                     <div class="card p-6 md:p-8">
                        <h3 class="text-xl font-bold text-slate-800">Network Devices (Switches, Routers, Firewalls)</h3>
                        <p class="mt-2 text-slate-600">Wazuh can analyze logs from devices where an agent cannot be installed.</p>
                        <ul class="list-disc list-inside mt-4 space-y-2 text-slate-600">
                            <li><strong>Method:</strong> Configure your network devices to send syslog data to the Wazuh Manager. The manager must be configured to accept remote syslog messages on a specific port (e.g., UDP 514).</li>
                            <li><strong>Configuration:</strong> Add a `<remote>` block in the Wazuh Manager's `ossec.conf` to specify the syslog port and allowed source IPs.</li>
                            <li><strong>Key Focus:</strong> You'll need to write or use existing decoders and rules to parse the specific log format of your devices (Cisco, Juniper, etc.). This allows Wazuh to generate alerts for firewall denies, configuration changes, and login failures.</li>
                            <li><strong>Best Practice:</strong> Send these logs to a dedicated syslog server first (like Rsyslog), which then forwards them to both Wazuh and Logstash/Splunk. This creates a resilient and flexible logging pipeline.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section id="synergy" class="mt-20 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-900 text-center">The Synergy: XDR Data vs. Raw Logs in Production</h2>
             <p class="mt-4 max-w-3xl mx-auto text-center text-lg text-slate-600">Does it make sense to have XDR in your prod environment alongside Splunk? Yes‚Äîbecause Wazuh provides rich security context and capabilities that raw logs alone cannot offer, transforming your reactive monitoring into a proactive security posture.</p>
            
            <div class="mt-12 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="card p-5 synergy-card">
                    <h4 class="font-bold text-slate-800">File Integrity Monitoring (FIM)</h4>
                    <p class="text-sm text-slate-600 mt-2">Instead of just seeing a log that a process started, Wazuh tells you if that process modified a critical system file (`/etc/passwd`), providing immediate evidence of a potential attack.</p>
                </div>
                <div class="card p-5 synergy-card">
                    <h4 class="font-bold text-slate-800">Vulnerability Detection</h4>
                    <p class="text-sm text-slate-600 mt-2">Wazuh actively scans for known vulnerabilities (CVEs) on your assets. This data in Splunk allows you to correlate an exploit attempt with a known, unpatched vulnerability on the target system.</p>
                </div>
                <div class="card p-5 synergy-card">
                    <h4 class="font-bold text-slate-800">Security Configuration Assessment (SCA)</h4>
                    <p class="text-sm text-slate-600 mt-2">Wazuh checks hosts against security benchmarks (e.g., CIS). An SCA failure alert in Splunk can provide context for why a specific attack was successful (e.g., weak password policy).</p>
                </div>
                <div class="card p-5 synergy-card">
                    <h4 class="font-bold text-slate-800">Threat Intelligence Integration</h4>
                    <p class="text-sm text-slate-600 mt-2">Wazuh can check file hashes and network connections against threat intelligence feeds. An alert for a connection to a known C2 server is far more valuable than a simple raw network log.</p>
                </div>
                 <div class="card p-5 synergy-card">
                    <h4 class="font-bold text-slate-800">Rootkit & Malware Detection</h4>
                    <p class="text-sm text-slate-600 mt-2">Performs signature and behavior-based checks to find hidden threats on the endpoint itself, generating high-fidelity alerts that are often invisible in standard logs.</p>
                </div>
                 <div class="card p-5 synergy-card">
                    <h4 class="font-bold text-slate-800">Active Response</h4>
                    <p class="text-sm text-slate-600 mt-2">While Splunk is for analysis, Wazuh can take immediate, automated action on the endpoint. An analyst in Splunk can trigger a Wazuh active response (e.g., block an IP, quarantine a host) to contain threats in real-time, drastically reducing incident response time.</p>
                </div>
                 <div class="card p-5 synergy-card bg-indigo-50 border-indigo-200">
                    <h4 class="font-bold text-indigo-800">Incident Response Acceleration</h4>
                    <p class="text-sm text-slate-600 mt-2">Wazuh provides a complete forensic trail‚Äîprocess lineage, file hashes, user activity‚Äîall correlated within a single alert. This eliminates hours of manual log correlation in Splunk, allowing your team to understand the full attack chain and remediate faster.</p>
                </div>
                 <div class="card p-5 synergy-card bg-indigo-50 border-indigo-200">
                    <h4 class="font-bold text-indigo-800">Proactive Threat Hunting</h4>
                    <p class="text-sm text-slate-600 mt-2">The rich endpoint data from Wazuh enables your security team to proactively hunt for threats in Splunk. You can search for subtle indicators of compromise (IOCs) or anomalous behaviors that haven't triggered an alert yet, stopping attacks before they escalate.</p>
                </div>
                 <div class="card p-5 synergy-card bg-indigo-50 border-indigo-200">
                    <h4 class="font-bold text-indigo-800">Compliance & Auditing</h4>
                    <p class="text-sm text-slate-600 mt-2">For audits like PCI-DSS or HIPAA, Wazuh provides concrete evidence that security controls are active. FIM reports prove critical files aren't tampered with, and SCA scans validate system hardening, satisfying auditors with data, not just policies.</p>
                </div>
            </div>

            <div class="mt-12 card p-6 md:p-8">
                 <h3 class="text-xl font-semibold text-slate-800 text-center">Data Richness in Splunk</h3>
                 <div class="chart-container mt-6">
                    <canvas id="synergyChart"></canvas>
                 </div>
            </div>
        </section>

        <section id="practices" class="mt-20 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-900 text-center">Implementation Best Practices</h2>
            <p class="mt-4 max-w-3xl mx-auto text-center text-lg text-slate-600">Key recommendations for deploying Wazuh effectively in both corporate and production environments.</p>

            <div class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-slate-800">üè¢ Local / Corporate Environment</h3>
                    <ul class="mt-4 space-y-4 text-slate-600">
                        <li class="flex items-start">
                            <span class="text-indigo-500 mr-3 mt-1">‚úì</span>
                            <span><strong>Start with High-Visibility Policies:</strong> Focus on rules for malware detection, unauthorized software installation, and monitoring of sensitive data access on file servers. These provide quick wins.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-indigo-500 mr-3 mt-1">‚úì</span>
                            <span><strong>Use Agent Groups:</strong> Create groups for different departments (e.g., 'IT', 'Finance', 'Developers') to apply tailored security policies. Not everyone needs the same level of FIM strictness.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-indigo-500 mr-3 mt-1">‚úì</span>
                            <span><strong>Educate on USB/Device Control:</strong> Use Wazuh's device control to enforce policies, but communicate these changes to users to avoid confusion and support tickets.</span>
                        </li>
                         <li class="flex items-start">
                            <span class="text-indigo-500 mr-3 mt-1">‚úì</span>
                            <span><strong>Integrate with IT Asset Management:</strong> Correlate Wazuh agent information with your asset database in Splunk to ensure full coverage and identify unprotected endpoints.</span>
                        </li>
                    </ul>
                </div>
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-slate-800">üöÄ Production Environments</h3>
                    <ul class="mt-4 space-y-4 text-slate-600">
                        <li class="flex items-start">
                             <span class="text-indigo-500 mr-3 mt-1">‚úì</span>
                            <span><strong>Tune, Tune, Tune:</strong> Production systems are noisy. Spend significant time tuning rules and FIM configurations to reduce false positives. A noisy alert system is an ignored alert system.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-indigo-500 mr-3 mt-1">‚úì</span>
                             <span><strong>Isolate Manager & Indexer:</strong> Run your Wazuh Manager and Indexer on dedicated, hardened infrastructure. Do not expose them to the public internet. Ensure they have sufficient CPU/RAM for your agent count.</span>
                        </li>
                        <li class="flex items-start">
                             <span class="text-indigo-500 mr-3 mt-1">‚úì</span>
                             <span><strong>Use a Scalable Architecture:</strong> For large deployments, consider a multi-node Wazuh cluster for high availability and load balancing. Place Logstash or forwarders between Wazuh and Splunk for buffering.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-indigo-500 mr-3 mt-1">‚úì</span>
                            <span><strong>Automate Agent Deployment:</strong> Integrate agent installation into your infrastructure-as-code (Terraform, Ansible) and CI/CD pipelines to ensure all new assets are automatically monitored from day one.</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>
        
        <section id="ai-generator" class="mt-20 scroll-mt-20">
            <h2 class="text-3xl font-bold text-slate-900 text-center">‚ú® AI-Powered Rule Generator</h2>
            <p class="mt-4 max-w-3xl mx-auto text-center text-lg text-slate-600">Struggling with custom decoders? Paste a sample log from any source, and let Gemini generate a Wazuh decoder and rule for you.</p>

            <div class="mt-12 card p-6 md:p-8 max-w-4xl mx-auto">
                <div class="space-y-4">
                    <div>
                        <label for="sample-log" class="block text-sm font-medium text-slate-700">Paste your sample log here:</label>
                        <textarea id="sample-log" rows="4" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2" placeholder="Example: Oct 11 22:14:15 my-firewall %ASA-4-106023: Deny tcp src inside:192.168.1.10/1234 dst outside:8.8.8.8/53 by access-group 'inside_access_in'"></textarea>
                    </div>
                    <button id="generate-rule-btn" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        Generate Decoder & Rule
                    </button>
                </div>

                <div id="ai-results" class="mt-8 hidden">
                    <div id="loading-spinner" class="flex items-center justify-center space-x-2">
                        <div class="w-4 h-4 rounded-full animate-pulse bg-indigo-600"></div>
                        <div class="w-4 h-4 rounded-full animate-pulse bg-indigo-600" style="animation-delay: 0.2s;"></div>
                        <div class="w-4 h-4 rounded-full animate-pulse bg-indigo-600" style="animation-delay: 0.4s;"></div>
                        <span class="text-slate-600">Generating with Gemini...</span>
                    </div>

                    <div id="error-message" class="hidden p-4 bg-red-50 border border-red-200 rounded-lg text-red-800"></div>
                    
                    <div id="generated-content" class="hidden space-y-6">
                        <div>
                            <h3 class="text-xl font-semibold text-slate-800">Generated Decoder</h3>
                            <p class="text-sm text-slate-500 mt-1">Add this to <code class="text-xs bg-slate-100 p-1 rounded">/var/ossec/etc/decoders/local_decoder.xml</code> on your Wazuh Manager.</p>
                            <pre class="mt-2 bg-slate-900 text-white p-4 rounded-md text-sm overflow-x-auto"><code id="decoder-output"></code></pre>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-slate-800">Generated Rule</h3>
                            <p class="text-sm text-slate-500 mt-1">Add this to <code class="text-xs bg-slate-100 p-1 rounded">/var/ossec/etc/rules/local_rules.xml</code> on your Wazuh Manager.</p>
                            <pre class="mt-2 bg-slate-900 text-white p-4 rounded-md text-sm overflow-x-auto"><code id="rule-output"></code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-slate-800 text-slate-400 mt-20">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 text-center text-sm">
            <p>This interactive guide was generated to assist with Wazuh XDR and Splunk SIEM integration.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('main section');

            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.3
            };

            const observer = new IntersectionObserver((entries, obs) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => {
                            link.classList.toggle('active', link.getAttribute('href').substring(1) === entry.target.id);
                        });
                    }
                });
            }, observerOptions);

            sections.forEach(section => {
                observer.observe(section);
            });
            
            navLinks.forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });

            const blueprintTabs = document.getElementById('blueprint-tabs');
            const blueprintPanes = document.querySelectorAll('.blueprint-pane');

            blueprintTabs.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    const targetId = e.target.dataset.target;

                    blueprintTabs.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
                    e.target.classList.add('active');

                    blueprintPanes.forEach(pane => {
                        pane.style.display = pane.id === targetId ? 'block' : 'none';
                    });
                }
            });

            const generateRuleBtn = document.getElementById('generate-rule-btn');
            const sampleLogInput = document.getElementById('sample-log');
            const aiResultsContainer = document.getElementById('ai-results');
            const loadingSpinner = document.getElementById('loading-spinner');
            const errorMessage = document.getElementById('error-message');
            const generatedContent = document.getElementById('generated-content');
            const decoderOutput = document.getElementById('decoder-output');
            const ruleOutput = document.getElementById('rule-output');

            const callGeminiApi = async (log) => {
                const apiKey = ""; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                const systemPrompt = `You are an expert in Wazuh security. Your task is to create a Wazuh decoder and a corresponding rule in XML format based on a sample log provided by the user. 
                
                - The decoder should correctly parse the important fields from the log.
                - The rule should be level 5 or higher, have a descriptive text, and include relevant MITRE ATT&CK IDs if applicable.
                - Respond ONLY with a valid JSON object containing two keys: "decoder" and "rule". 
                - The values for these keys should be strings containing the complete, well-formatted XML code. 
                - Do not include any explanatory text or markdown formatting like \`\`\`xml in your response.`;

                const payload = {
                    contents: [{
                        parts: [{ text: `Here is the sample log: ${log}` }]
                    }],
                    systemInstruction: {
                        parts: [{ text: systemPrompt }]
                    },
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: {
                            type: "OBJECT",
                            properties: {
                                "decoder": { "type": "STRING" },
                                "rule": { "type": "STRING" }
                            },
                            required: ["decoder", "rule"]
                        }
                    }
                };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`API call failed with status: ${response.status}`);
                    }

                    const result = await response.json();
                    
                    if (result.candidates && result.candidates[0].content && result.candidates[0].content.parts[0].text) {
                        const parsedJson = JSON.parse(result.candidates[0].content.parts[0].text);
                        return parsedJson;
                    } else {
                        throw new Error("Invalid response structure from API.");
                    }
                } catch (error) {
                    console.error("Error calling Gemini API:", error);
                    throw error;
                }
            };

            generateRuleBtn.addEventListener('click', async () => {
                const sampleLog = sampleLogInput.value.trim();
                if (!sampleLog) {
                    alert("Please paste a sample log first.");
                    return;
                }

                aiResultsContainer.style.display = 'block';
                loadingSpinner.style.display = 'flex';
                generatedContent.style.display = 'none';
                errorMessage.style.display = 'none';
                generateRuleBtn.disabled = true;
                generateRuleBtn.textContent = 'Generating...';

                try {
                    const result = await callGeminiApi(sampleLog);
                    decoderOutput.textContent = result.decoder;
                    ruleOutput.textContent = result.rule;

                    loadingSpinner.style.display = 'none';
                    generatedContent.style.display = 'block';

                } catch (err) {
                    loadingSpinner.style.display = 'none';
                    errorMessage.textContent = 'An error occurred while generating the rule. Please check the console for details and try again.';
                    errorMessage.style.display = 'block';
                } finally {
                     generateRuleBtn.disabled = false;
                     generateRuleBtn.textContent = 'Generate Decoder & Rule';
                }
            });


            const synergyChartCtx = document.getElementById('synergyChart').getContext('2d');
            new Chart(synergyChartCtx, {
                type: 'bar',
                data: {
                    labels: ['Investigation Context', 'Proactive Detection', 'Response Fidelity', 'Forensic & Audit Trail'],
                    datasets: [{
                        label: 'Standard Logs Only',
                        data: [40, 30, 50, 35],
                        backgroundColor: '#cbd5e1', // slate-300
                        borderColor: '#94a3b8', // slate-400
                        borderWidth: 1
                    }, {
                        label: 'Logs + Wazuh XDR Data',
                        data: [90, 85, 95, 90],
                        backgroundColor: '#6366f1', // indigo-500
                        borderColor: '#4f46e5', // indigo-600
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                             grid: { color: '#e2e8f0' }, // slate-200
                             ticks: { color: '#64748b' } // slate-500
                        },
                        x: {
                             grid: { display: false },
                             ticks: { 
                                color: '#64748b', // slate-500
                                 maxRotation: 0,
                                 minRotation: 0,
                                 autoSkip: false,
                                 callback: function(value) {
                                    const label = this.getLabelForValue(value);
                                    if (/\s/.test(label)) {
                                        return label.split(" ");
                                    }else{
                                        return label;
                                    }              
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#334155' // slate-700
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                     indexAxis: 'x'
                }
            });
        });
    </script>
</body>
</html>

